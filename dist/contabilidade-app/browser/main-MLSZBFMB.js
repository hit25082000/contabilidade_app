import{d as Ue}from"./chunk-WHTHJCRK.js";import{a as m}from"./chunk-6WNS7CKB.js";import{h as We,m as $e}from"./chunk-DCKODCDW.js";import{$ as s,A as u,Ab as fe,Ac as Se,Bc as Ee,C as ee,Cc as Ce,Dc as Me,F as f,Fc as Ne,G as te,Gc as Pe,Ja as O,Jd as Ae,Kc as Ie,Kd as ke,L as re,Ld as De,M as oe,Md as Re,Nd as _e,Oc as Oe,Od as je,Pa as pe,Pd as xe,Q as y,Qb as me,Qc as Te,Qd as Le,Ra as de,Rd as Fe,Sa as W,Sb as he,Sd as ze,T as b,Td as Be,Ud as He,X as c,Z as ie,_ as V,_b as ge,ae as Ve,bb as le,be as qe,ca as ne,d as J,da as se,gb as $,hb as ue,ib as T,kc as ve,l as Z,m as M,ma as ae,n as N,p,pa as ce,s as G,sa as P,sc as U,t as z,tc as A,ua as I,uc as be,v as B,w as Q,x as X,y as H,yc as we,z as v,zc as ye}from"./chunk-QWKNK35R.js";import{a as Y,i as d}from"./chunk-ODN5LVDJ.js";var E="Service workers are disabled or not supported by this browser";function tt(t){return z(()=>N(new Error(t)))}var w=class{serviceWorker;worker;registration;events;constructor(r){if(this.serviceWorker=r,!r)this.worker=this.events=this.registration=tt(E);else{let o=B(r,"controllerchange").pipe(p(()=>r.controller)),n=z(()=>M(r.controller)),a=G(n,o);this.worker=a.pipe(u(g=>!!g)),this.registration=this.worker.pipe(y(()=>r.getRegistration()));let K=B(r,"message").pipe(p(g=>g.data)).pipe(u(g=>g&&g.type)).pipe(re());K.connect(),this.events=K}}postMessage(r,e){return this.worker.pipe(f(1),b(o=>{o.postMessage(Y({action:r},e))})).toPromise().then(()=>{})}postMessageWithOperation(r,e,o){let n=this.waitForOperationCompleted(o),a=this.postMessage(r,e);return Promise.all([a,n]).then(([,i])=>i)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(r){let e;return typeof r=="string"?e=o=>o.type===r:e=o=>r.includes(o.type),this.events.pipe(u(e))}nextEventOfType(r){return this.eventsOfType(r).pipe(f(1))}waitForOperationCompleted(r){return this.eventsOfType("OPERATION_COMPLETED").pipe(u(e=>e.nonce===r),f(1),p(e=>{if(e.result!==void 0)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},C=(()=>{class t{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new J;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=v,this.notificationClicks=v,this.subscription=v;return}this.messages=this.sw.eventsOfType("PUSH").pipe(p(n=>n.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(p(n=>n.data)),this.pushManager=this.sw.registration.pipe(p(n=>n.pushManager));let o=this.pushManager.pipe(y(n=>n.getSubscription()));this.subscription=H(o,this.subscriptionChanges)}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(E));let o={userVisibleOnly:!0},n=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(n.length));for(let i=0;i<n.length;i++)a[i]=n.charCodeAt(i);return o.applicationServerKey=a,this.pushManager.pipe(y(i=>i.subscribe(o)),f(1)).toPromise().then(i=>(this.subscriptionChanges.next(i),i))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(E));let e=o=>{if(o===null)throw new Error("Not subscribed to push notifications.");return o.unsubscribe().then(n=>{if(!n)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(f(1),y(e)).toPromise()}decodeBase64(e){return atob(e)}static \u0275fac=function(o){return new(o||t)(V(w))};static \u0275prov=c({token:t,factory:t.\u0275fac})}return t})(),q=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=v,this.unrecoverable=v;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(E));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(E));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(o){return new(o||t)(V(w))};static \u0275prov=c({token:t,factory:t.\u0275fac})}return t})();var Ke=new ie("");function rt(t,r,e){return()=>{if(!("serviceWorker"in navigator&&e.enabled!==!1))return;let o=t.get(ce),n=t.get(W);o.runOutsideAngular(()=>{let i=navigator.serviceWorker,l=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",l),n.onDestroy(()=>{i.removeEventListener("controllerchange",l)})});let a;if(typeof e.registrationStrategy=="function")a=e.registrationStrategy();else{let[i,...l]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(i){case"registerImmediately":a=M(null);break;case"registerWithDelay":a=Ye(+l[0]||0);break;case"registerWhenStable":let F=Z(t.get(W).whenStable());a=l[0]?H(F,Ye(+l[0])):F;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}o.runOutsideAngular(()=>a.pipe(f(1)).subscribe(()=>navigator.serviceWorker.register(r,{scope:e.scope}).catch(i=>console.error("Service worker registration failed with:",i))))}}function Ye(t){return M(null).pipe(te(t))}function ot(t){return new w(t.enabled!==!1?navigator.serviceWorker:void 0)}var S=class{enabled;scope;registrationStrategy};function Je(t,r={}){return ne([C,q,{provide:Ke,useValue:t},{provide:S,useValue:r},{provide:w,useFactory:ot,deps:[S]},{provide:de,useFactory:rt,deps:[ae,Ke,S],multi:!0}])}var Ze=[{path:"",redirectTo:"auth",pathMatch:"full"},{path:"auth",canActivate:[Ue],children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-LTX3BEY3.js").then(t=>t.LoginComponent)},{path:"registro",loadComponent:()=>import("./chunk-B4ZRHIM6.js").then(t=>t.RegisterComponent)},{path:"recuperar-senha",loadComponent:()=>import("./chunk-QDB2TUKS.js").then(t=>t.ResetPasswordComponent)},{path:"nova-senha",loadComponent:()=>import("./chunk-V65MPANU.js").then(t=>t.NewPasswordComponent)}]},{path:"contador",loadChildren:()=>import("./chunk-BPLDW4Q6.js").then(t=>t.CONTADOR_ROUTES)},{path:"cliente",loadChildren:()=>import("./chunk-HAN4QL6F.js").then(t=>t.CLIENTE_ROUTES)}];function it(t){let r=t,e=Math.floor(Math.abs(t)),o=t.toString().replace(/^[^.]*\.?/,"").length,n=parseInt(t.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return e===Math.floor(e)&&e>=0&&e<=1?1:n===0&&e!==0&&e%1e6===0&&o===0||!(n>=0&&n<=5)?4:5}var Ge=["pt",[["AM","PM"],void 0,void 0],void 0,[["D","S","T","Q","Q","S","S"],["dom.","seg.","ter.","qua.","qui.","sex.","s\xE1b."],["domingo","segunda-feira","ter\xE7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xE1bado"],["dom.","seg.","ter.","qua.","qui.","sex.","s\xE1b."]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],["janeiro","fevereiro","mar\xE7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]],void 0,[["a.C.","d.C."],void 0,["antes de Cristo","depois de Cristo"]],0,[6,0],["dd/MM/y","d 'de' MMM 'de' y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}",void 0,void 0,void 0],[",",".",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4\xA0#,##0.00","#E0"],"BRL","R$","Real brasileiro",{AUD:["AU$","$"],BYN:[void 0,"\u0440."],JPY:["JP\xA5","\xA5"],PHP:[void 0,"\u20B1"],PTE:["Esc."],RON:[void 0,"L"],SYP:[void 0,"S\xA3"],THB:["\u0E3F"],TWD:["NT$"],USD:["US$","$"]},"ltr",it];var nt=[xe,je,_e,Re,He,ke,De,Fe,ze,Ae,Le,Be];function Qe(){return se(Ve.forRoot(nt))}var Xe=(t,r)=>{let o=s(Te).session();if([m.SUPABASE_URL].some(i=>t.url.includes(i)))return r(t);if(o?.access_token){let i=t.clone({headers:t.headers.set("Authorization",`Bearer ${o.access_token}`)});return r(i)}return r(t)};ve(Ge);var et={providers:[Oe(Ze),me({eventCoalescing:!0}),Pe(Ne()),Je("ngsw-worker.js",{enabled:!he(),registrationStrategy:"registerWhenStable:30000"}),ye(Se([Xe])),qe(),We($e),Qe()]};var k=class t{platformId=s(I);isBrowser=A(this.platformId);_isOnline=P(this.isBrowser?navigator.onLine:!0);constructor(){this.isBrowser&&(window.addEventListener("online",()=>this._isOnline.set(!0)),window.addEventListener("offline",()=>this._isOnline.set(!1)))}get isOnline(){return this._isOnline}static \u0275fac=function(e){return new(e||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};var D=class t{swPush=s(C);http=s(we);platformId=s(I);VAPID_PUBLIC_KEY=m.PUBLIC_VAPID_KEY;baseUrl=m.PUSH_NOTIFICATIONS_URL;get headers(){return new be({"Content-Type":"application/json",Authorization:`Bearer ${m.SUPABASE_FUNCTIONS_TOKEN}`,apikey:m.SUPABASE_ANON_KEY})}constructor(){this.subscribeToNotifications(),this.setupNotificationListener()}getSubscription(){return d(this,null,function*(){if(!this.swPush.isEnabled)return null;try{let r=yield this.swPush.subscription.toPromise();return r||(r=yield this.swPush.requestSubscription({serverPublicKey:this.VAPID_PUBLIC_KEY})),r}catch{return null}})}subscribeToNotifications(){this.swPush.isEnabled&&this.swPush.requestSubscription({serverPublicKey:this.VAPID_PUBLIC_KEY}).then(r=>{this.sendSubscriptionToServer(r).subscribe({next:e=>console.log("[NotificationService] Inscri\xE7\xE3o registrada no servidor:",e),error:e=>console.error("[NotificationService] Erro ao registrar inscri\xE7\xE3o:",e)})}).catch(r=>console.error("[NotificationService] Erro ao se inscrever nas notifica\xE7\xF5es:",r))}requestPermission(){return this.notificationSupported?window.Notification.requestPermission().then(r=>r):Promise.reject("Notifications not supported")}showNotification(r,e){this.notificationSupported&&window.Notification.permission==="granted"&&new window.Notification(r,e)}isNotificationSupported(){return this.notificationSupported}getCurrentPermission(){return this.notificationSupported?window.Notification.permission:null}get notificationSupported(){return A(this.platformId)&&"Notification"in window}sendSubscriptionToServer(r){return this.http.post(this.baseUrl,r,{headers:this.headers,withCredentials:!1,observe:"response"}).pipe(b(e=>{}),p(e=>e.body),oe({count:3,delay:(e,o)=>(console.log(`[NotificationService] Tentativa ${o} de 3`),Q(1e3*o))}),ee(e=>N(()=>e)))}setupNotificationListener(){this.swPush.notificationClicks.subscribe(({action:r,notification:e})=>{e.data?.url&&(window.location.href=e.data.url)})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};var R=class t{swUpdate=s(q);constructor(){this.initializeUpdateChecks()}initializeUpdateChecks(){this.swUpdate.isEnabled&&(X(60*1e3).subscribe(()=>this.checkForUpdate()),this.swUpdate.versionUpdates.pipe(b(r=>`Evento de atualiza\xE7\xE3o: ${r.type}`),u(r=>r.type==="VERSION_READY")).subscribe(()=>this.promptUserToUpdate()),this.swUpdate.unrecoverable.subscribe(()=>{alert("Um erro ocorreu. O aplicativo ser\xE1 recarregado."),window.location.reload()}))}checkForUpdate(){return d(this,null,function*(){if(!this.swUpdate.isEnabled)return!1;try{return yield this.swUpdate.checkForUpdate()}catch(r){return console.error("Erro ao verificar atualiza\xE7\xF5es:",r),!1}})}promptUserToUpdate(){confirm("Nova vers\xE3o dispon\xEDvel. Deseja atualizar agora?")&&this.swUpdate.activateUpdate().then(()=>window.location.reload()).catch(r=>console.error("Erro ao ativar atualiza\xE7\xE3o:",r))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};var _=class t{checkAssetsCache(){return d(this,null,function*(){if(typeof window>"u"||!("caches"in window))return[];try{let r=[],e=yield window.caches.keys();for(let o of e)if(o.includes("ngsw")){let a=yield(yield window.caches.open(o)).keys();r.push(...a.filter(i=>i.url.includes("/assets/")).map(i=>({path:new URL(i.url).pathname})))}return r}catch(r){return console.error("Erro ao verificar cache:",r),[]}})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};var j=class t{loading=P(!1);isLoading(){return this.loading()}show(){queueMicrotask(()=>this.loading.set(!0))}hide(){queueMicrotask(()=>this.loading.set(!1))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};function at(t,r){t&1&&($(0,"div",0)(1,"div",1),T(2,"div",2),$(3,"div",3),fe(4,"Carregando..."),ue()()())}var x=class t{loadingService=s(j);static \u0275fac=function(e){return new(e||t)};static \u0275cmp=O({type:t,selectors:[["app-loading-overlay"]],decls:1,vars:1,consts:[[1,"loading-overlay"],[1,"spinner-container"],[1,"spinner"],[1,"spinner-text"]],template:function(e,o){e&1&&pe(0,at,5,0,"div",0),e&2&&le(o.loadingService.isLoading()?0:-1)},dependencies:[U],styles:[".loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000000b3;display:grid;place-items:center;z-index:9999;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.spinner-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}.spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.spinner-text[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};var L=class t{connectivityService=s(k);notificationService=s(D);cacheInspector=s(_);updateService=s(R);swPush=s(C);title=s(Me);meta=s(Ce);constructor(){ge(()=>{if(!this.connectivityService.isOnline()){this.notificationService.showNotification("Notifica\xE7\xE3o",{body:"Voc\xEA est\xE1 offline :("});return}this.notificationService.showNotification("Notifica\xE7\xE3o",{body:"Voc\xEA est\xE1 online :)"})})}ngOnInit(){return d(this,null,function*(){this.setPageMeta(),this.swPush.messages.subscribe(e=>{let o=e;this.notificationService.showNotification("Notification",{body:o.body})});let r=yield this.updateService.checkForUpdate();this.cacheInspector.checkAssetsCache()})}setPageMeta(){this.title.setTitle("Deleite - a melhor experi\xEAncia de sabores!"),this.meta.addTags([{name:"description",content:"Descubra os melhores milkshakes, sorvetes e smoothies na Deleite. Sabor e qualidade em cada produto!"},{property:"og:title",content:"Deleite - a melhor experi\xEAncia de sabores!"},{property:"og:description",content:"Descubra os melhores milkshakes, sorvetes e smoothies na Deleite. Sabor e qualidade em cada produto!"},{property:"og:image",content:"assets/images/logo.png"},{name:"twitter:card",content:"summary_large_image"}])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=O({type:t,selectors:[["app-root"]],decls:2,vars:0,template:function(e,o){e&1&&T(0,"router-outlet")(1,"app-loading-overlay")},dependencies:[Ie,U,x],encapsulation:2})};Ee(L,et).catch(t=>console.error("Erro ao inicializar a aplica\xE7\xE3o:",t));
